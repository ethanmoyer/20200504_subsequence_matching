

match = 0.1;
accession_file = 'seq.txt';
# Searched '(mycobacterium) AND "Mycolicibacterium rufum"[porgn:__txid318424]' between 1000 and 5000 nucleotides under Batceria, Nucleotide on GenBank
#warning('off', 'bioinfo:localalign:EmptyAlignment')
fileID = fopen(accession_file);
seq_accessions = textscan(fileID, '%s');
# Set l based on the number of data files in the /data directory--number of
# elements divided by 10.

fragment_range = 150;
overhang_range = 0:10;

for j = 1:numel(seq_accessions) %seq_accessions{:}
    data = getgenbank(seq_accessions{1}{j});
    sequence = data.Sequence;
    
    if isempty(sequence)
        continue
    end
    %for overhang = overhang_range
    %    overhang
        for fragment_length = fragment_range
            fragments = getFragments(sequence, fragment_length);
            for i = 1:numel(fragments)
                set = lower(generateDNA(1e5, .25, .25, .25, .25));
                i
                 generateNonopTable(set, fragments{i}, match, ...
                    seq_accessions{1}{j}, fragment_length, i);
                %generateOpTable(set, overhang, fragments{i}, match, ... 
                %    seq_accessions{1}{j}, fragment_length, i);
            end
        %end
        end
end

end

function fragments = getFragments(sequence, fragment_length)
    fragments = cell(numel(sequence) - fragment_length + 1, 1);
    for i = 1:numel(sequence) - fragment_length
       fragments{i} = sequence(i:i + fragment_length - 1);
    end
end